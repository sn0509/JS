<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h2>Online Shop</h2>
    <label> Amount: </label>
    <input
      id="amount"
      type="text"
      oninput="dinhDang(this.value)"
      onchange="dinhDang(this.value)"
    /><br /><br />
    <input type="checkbox" id="membership" value="Member Ship" />
    <label for="vehicle1"> Member Ship </label><br /><br />
    <button onclick="check()">Calculate</button><br /><br />
    <p>-------------------------------------------------------</p>
    <form>
      <label> Discount: </label>
      <input type="text" id="discount" /><br /><br />
      <label> Total: </label>
      <input type="text" id="total" />
    </form>
    <p>
      Nhập số tiền vào trong ô Amount, sau đó chọn khách hàng có là thành viên
      hay không ở ô Member Ship. Với điều kiện
    </p>
    <p>1. Nếu khách hàng là member ship thì sẽ giảm giá 5% trên tổng hóa đơn</p>
    <p>2. Nếu khách hàng mua hàng với giá trị:</p>
    <p>&nbsp;&nbsp;2.1. Trên 500,000 thì giảm giá 5.1% trên tổng hóa đơn</p>
    <p>&nbsp;&nbsp;2.2. Dưới 200,000 thì giảm giá 3.0% trên tổng hóa đơn</p>
    <p>
      &nbsp;&nbsp;2.3. Từ 200,000 -> 500,000 thì giảm giá 4.32% trên tổng hóa
      đơn
    </p>
    <p>
      Câu hỏi: Viết đoạn script tính: Số tiền sau khi giảm giá, và % giảm giá
    </p>
    <script>
      //         var fnf = document.getElementById("amount");
      // fnf.addEventListener('keyup', function(evt){
      //     var n = parseInt(this.value.replace(/\D/g,''),10);
      //     fnf.value = n.toLocaleString();
      // }, false);
      function check() {
        let membership = document.getElementById("membership").checked;
        let number = document.getElementById("amount").value;
        console.log(number);
        if (isNumeric(number)) {
          number = parseFloat(number);
        } else {
          while (number.indexOf(",") != -1) {
            number = number.replace(",", " ");
          }
        }

        console.log(number);
        let discount = +document.getElementById("discount").value;
        if (number > 500000) {
          discount = 5.1 / 100;
        } else if (number >= 200000) {
          discount = 4.32 / 100;
        } else {
          discount = 3 / 100;
        }
        if (membership) {
          discount = discount + 5 / 100;
        }
        // document
        //   .getElementById("discount")
        //   .setAttribute(
        //     "value",
        //     +Intl.NumberFormat("en-US").format(discount * 100) + "%"
        //   );
        document.getElementById("discount").value =
          Intl.NumberFormat("en-US").format(discount * 100) + "%";
        document
          .getElementById("total")
          .setAttribute(
            "value",
            Intl.NumberFormat("en-US").format(number - discount * number)
          );
      }

      function isNumeric(value) {
        return !isNaN(value) && isFinite(value);
      }

      function dinhDang(value) {
        if (isNumeric(value)) {
          value = parseInt(value);
        } else {
          value = parseInt(value.replace(/\D/g, ""), 10);
        }
        value = Intl.NumberFormat("en-US").format(value);
        document.getElementById("amount").value = value;
      }
    </script>
  </body>
</html>
